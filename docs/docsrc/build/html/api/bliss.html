

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bliss package &mdash; bliss  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Bliss API" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            bliss
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Bliss API</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">bliss package</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">bliss</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Bliss API</a></li>
      <li class="breadcrumb-item active">bliss package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/bliss.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bliss-package">
<h1>bliss package<a class="headerlink" href="#bliss-package" title="Link to this heading"></a></h1>
<p>BLISS is organized into several subpackages:</p>
<ul class="simple">
<li><p><strong>Core modules</strong>: Entry points, catalogs, datasets, and utilities</p></li>
<li><p><strong>Encoder</strong>: Neural network architecture for posterior estimation</p></li>
<li><p><strong>Simulator</strong>: Image generation and prior distributions</p></li>
<li><p><strong>Surveys</strong>: Survey-specific data loaders (SDSS, DES, DC2)</p></li>
</ul>
<section id="core-modules">
<h2>Core Modules<a class="headerlink" href="#core-modules" title="Link to this heading"></a></h2>
<section id="bliss-main-module">
<h3>bliss.main module<a class="headerlink" href="#bliss-main-module" title="Link to this heading"></a></h3>
<p>The main entry point for BLISS workflows: data generation, training, and prediction.</p>
<dl class="py function" id="module-bliss.main">
<dt class="sig sig-object py" id="bliss.main.main">
<span class="sig-prename descclassname"><span class="pre">bliss.main.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/main.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.main.main" title="Link to this definition"></a></dt>
<dd><p>Main entry point(s) for BLISS.</p>
</dd></dl>

</section>
<section id="bliss-catalog-module">
<h3>bliss.catalog module<a class="headerlink" href="#bliss-catalog-module" title="Link to this heading"></a></h3>
<p>Tile and full catalog data structures for representing light source parameters.</p>
<dl class="py class" id="module-bliss.catalog">
<dt class="sig sig-object py" id="bliss.catalog.BaseTileCatalog">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.catalog.</span></span><span class="sig-name descname"><span class="pre">BaseTileCatalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#BaseTileCatalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.BaseTileCatalog" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.catalog.FullCatalog">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.catalog.</span></span><span class="sig-name descname"><span class="pre">FullCatalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#FullCatalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.FullCatalog" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.FullCatalog.apply_param_bin">
<span class="sig-name descname"><span class="pre">apply_param_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#FullCatalog.apply_param_bin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.FullCatalog.apply_param_bin" title="Link to this definition"></a></dt>
<dd><p>Apply magnitude bin to given parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.FullCatalog.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bliss.catalog.FullCatalog" title="bliss.catalog.FullCatalog"><span class="pre">FullCatalog</span></a></span></span><a class="reference internal" href="../_modules/bliss/catalog.html#FullCatalog.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.FullCatalog.from_dict" title="Link to this definition"></a></dt>
<dd><p>Create FullCatalog from unbatched dict by adding batch dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.FullCatalog.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cat_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bliss.catalog.FullCatalog" title="bliss.catalog.FullCatalog"><span class="pre">FullCatalog</span></a></span></span><a class="reference internal" href="../_modules/bliss/catalog.html#FullCatalog.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.FullCatalog.from_file" title="Link to this definition"></a></dt>
<dd><p>Loads FullCatalog from disk.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.FullCatalog.one_source">
<span class="sig-name descname"><span class="pre">one_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#FullCatalog.one_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.FullCatalog.one_source" title="Link to this definition"></a></dt>
<dd><p>Return a dict containing all parameter for one specified light source.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.FullCatalog.plocs_from_ra_dec">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plocs_from_ra_dec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ras</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">WCS</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#FullCatalog.plocs_from_ra_dec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.FullCatalog.plocs_from_ra_dec" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Converts RA/DEC coordinates into BLISS’s pixel coordinates.</dt><dd><p>BLISS pixel coordinates have (0, 0) as the lower-left corner, whereas standard pixel
coordinates begin at (-0.5, -0.5). BLISS pixel coordinates are in row-column order,
whereas standard pixel coordinates are in column-row order.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ras</strong> (<em>Tensor</em>) – (b, n) tensor of RA coordinates in degrees.</p></li>
<li><p><strong>decs</strong> (<em>Tensor</em>) – (b, n) tensor of DEC coordinates in degrees.</p></li>
<li><p><strong>wcs</strong> (<em>WCS</em>) – WCS object to use for transformation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1xNx2 tensor containing the locations of the light sources in pixel coordinates. This
function does not write self[“plocs”], so you should do that manually if necessary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.FullCatalog.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/bliss/catalog.html#FullCatalog.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.FullCatalog.to_dict" title="Link to this definition"></a></dt>
<dd><p>Convert to unbatched dict by removing batch dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.FullCatalog.to_tile_catalog">
<span class="sig-name descname"><span class="pre">to_tile_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile_slen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sources_per_tile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_extra_sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_oob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inter_int_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.int32</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bliss.catalog.TileCatalog" title="bliss.catalog.TileCatalog"><span class="pre">TileCatalog</span></a></span></span><a class="reference internal" href="../_modules/bliss/catalog.html#FullCatalog.to_tile_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.FullCatalog.to_tile_catalog" title="Link to this definition"></a></dt>
<dd><p>Returns the TileCatalog corresponding to this FullCatalog.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile_slen</strong> – The side length of the tiles.</p></li>
<li><p><strong>max_sources_per_tile</strong> – The maximum number of sources in one tile.</p></li>
<li><p><strong>ignore_extra_sources</strong> – If False (default), raises an error if the number of sources
in one tile exceeds the <cite>max_sources_per_tile</cite>. If True, only adds the tile
parameters of the first <cite>max_sources_per_tile</cite> sources to the new TileCatalog.</p></li>
<li><p><strong>filter_oob</strong> – If filter_oob is True (default is False),
filter out the sources outside the image.
(e.g. In case of data augmentation, there is a chance of some sources located
outside the image)</p></li>
<li><p><strong>stable</strong> – It stable is True (default), on tiles with more than one sources,
the sources will be arranged in a stable order.
Some speedup can be gained if you disable this tag.</p></li>
<li><p><strong>inter_int_type</strong> – The dtype for the tensors counting the sources per tile.
Default is torch.int32, and you can change it to torch.int8 to get speedup.
But the overflow may happen without any warning.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TileCatalog correspond to the each source in the FullCatalog.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the number of sources in one tile exceeds <cite>max_sources_per_tile</cite>
    and <cite>ignore_extra_sources</cite> is False.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.14)"><strong>KeyError</strong></a> – If the tile_params contain <cite>plocs</cite> or <cite>n_sources</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.catalog.SourceType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.catalog.</span></span><span class="sig-name descname"><span class="pre">SourceType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#SourceType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.SourceType" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.catalog.TileCatalog">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.catalog.</span></span><span class="sig-name descname"><span class="pre">TileCatalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#TileCatalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.TileCatalog" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.TileCatalog.filter_by_flux">
<span class="sig-name descname"><span class="pre">filter_by_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#TileCatalog.filter_by_flux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.TileCatalog.filter_by_flux" title="Link to this definition"></a></dt>
<dd><p>Restricts TileCatalog to sources that have a flux between min_flux and max_flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_flux</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Minimum flux value to keep. Defaults to 0.</p></li>
<li><p><strong>band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The band to compare fluxes in. Defaults to 2 (r-band).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a new catalog with only sources within the flux range. Note that the size</dt><dd><p>of the tensors stays the same, but params at sources outside the range are set to 0.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bliss.catalog.TileCatalog" title="bliss.catalog.TileCatalog">TileCatalog</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.TileCatalog.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bliss.catalog.TileCatalog" title="bliss.catalog.TileCatalog"><span class="pre">TileCatalog</span></a></span></span><a class="reference internal" href="../_modules/bliss/catalog.html#TileCatalog.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.TileCatalog.from_dict" title="Link to this definition"></a></dt>
<dd><p>Create TileCatalog from unbatched dict by adding batch dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.TileCatalog.get_brightest_sources_per_tile">
<span class="sig-name descname"><span class="pre">get_brightest_sources_per_tile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#TileCatalog.get_brightest_sources_per_tile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.TileCatalog.get_brightest_sources_per_tile" title="Link to this definition"></a></dt>
<dd><p>Restrict TileCatalog to only the brightest ‘on’ source per tile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>top_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The number of sources to keep per tile. Defaults to 1.</p></li>
<li><p><strong>exclude_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – A number of the brightest sources to exclude. Defaults to 0.</p></li>
<li><p><strong>band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The band to compare fluxes in. Defaults to 2 (r-band).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new catalog with only one source per tile</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bliss.catalog.TileCatalog" title="bliss.catalog.TileCatalog">TileCatalog</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.TileCatalog.get_indices_of_on_sources">
<span class="sig-name descname"><span class="pre">get_indices_of_on_sources</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/bliss/catalog.html#TileCatalog.get_indices_of_on_sources"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.TileCatalog.get_indices_of_on_sources" title="Link to this definition"></a></dt>
<dd><p>Get the indices of detected sources from each tile.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A 2-D tensor of integers with shape <cite>n_samples x max(n_sources)</cite>,
where <cite>max(n_sources)</cite> is the maximum number of sources detected across all samples.</p>
<p>Each element of this tensor is an index of a particular source within a particular tile.
For a particular sample i that had N detections,
the first N indices of indices_sorted[i. :] will be the detected sources.
This is accomplished by flattening the n_tiles_per_image and max_detections.
For example, if we had 3 tiles with a maximum of two sources each,
the elements of this tensor would take values from 0 up to and including 5.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bliss.catalog.TileCatalog.is_on_mask">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_on_mask</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#bliss.catalog.TileCatalog.is_on_mask" title="Link to this definition"></a></dt>
<dd><p>Provides tensor which indicates how many sources are present for each batch.</p>
<p>Return a boolean array of <cite>shape=(*n_sources.shape, max_sources)</cite> whose <cite>(*,l)th</cite> entry
indicates whether there are more than l sources on the <cite>*th</cite> index.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor indicating how many sources are present for each batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.TileCatalog.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/bliss/catalog.html#TileCatalog.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.TileCatalog.to_dict" title="Link to this definition"></a></dt>
<dd><p>Convert to unbatched dict by removing batch dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.TileCatalog.to_full_catalog">
<span class="sig-name descname"><span class="pre">to_full_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile_slen</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#TileCatalog.to_full_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.TileCatalog.to_full_catalog" title="Link to this definition"></a></dt>
<dd><p>Converts image parameters in tiles to parameters of full image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile_slen</strong> – The side length of the square tiles (in pixels).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The FullCatalog instance corresponding to the TileCatalog instance.</p>
<p>NOTE: The locations (<cite>“locs”</cite>) are between 0 and 1. The output also contains
pixel locations (“plocs”) that are between 0 and <cite>slen</cite>.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.catalog.TileCatalog.union">
<span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#TileCatalog.union"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.TileCatalog.union" title="Link to this definition"></a></dt>
<dd><p>Returns a new TileCatalog containing the union of the sources in self and other.
The maximum number of sources in the returned catalog is the sum of the maximum number
of sources in self and other if disjoint is false, otherwise it is unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> – Another TileCatalog.</p></li>
<li><p><strong>disjoint</strong> – whether the catalogs cannot have sources in the same tiles</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new TileCatalog containing the union of the sources in self and other.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bliss.catalog.convert_flux_to_magnitude">
<span class="sig-prename descclassname"><span class="pre">bliss.catalog.</span></span><span class="sig-name descname"><span class="pre">convert_flux_to_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_point</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/catalog.html#convert_flux_to_magnitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.catalog.convert_flux_to_magnitude" title="Link to this definition"></a></dt>
<dd><p>Convert from flux to magnitude.</p>
<p>For DC2, please set c to 3631e9.
The conversion is described in “2.10 AB magnitudes” at
<a class="reference external" href="https://pstn-001.lsst.io/fluxunits.pdf">https://pstn-001.lsst.io/fluxunits.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> – the flux in any linear unit</p></li>
<li><p><strong>zero_point</strong> – you may change this according to your survey dataset;</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor indicating fluxes in magnitude</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="bliss-cached-dataset-module">
<h3>bliss.cached_dataset module<a class="headerlink" href="#bliss-cached-dataset-module" title="Link to this heading"></a></h3>
<p>Dataset classes for loading cached simulated or survey data.</p>
<dl class="py class" id="module-bliss.cached_dataset">
<dt class="sig sig-object py" id="bliss.cached_dataset.CachedSimulatedDataModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.cached_dataset.</span></span><span class="sig-name descname"><span class="pre">CachedSimulatedDataModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cached_data_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_transforms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nontrain_transforms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_file_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#CachedSimulatedDataModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.CachedSimulatedDataModule" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.cached_dataset.CachedSimulatedDataModule.predict_dataloader">
<span class="sig-name descname"><span class="pre">predict_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#CachedSimulatedDataModule.predict_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.CachedSimulatedDataModule.predict_dataloader" title="Link to this definition"></a></dt>
<dd><p>An iterable or collection of iterables specifying prediction samples.</p>
<p>For more information about multiple dataloaders, see this <a class="reference external" href="https://lightning.ai/docs/pytorch/stable/data/iterables.html#multiple-dataloaders" title="(in PyTorch Lightning v2.6.0)"><span class="xref std std-ref">section</span></a>.</p>
<p>It’s recommended that all data downloads and preparation happen in <code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code>.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></p></li>
<li><p><a class="reference internal" href="#bliss.cached_dataset.CachedSimulatedDataModule.setup" title="bliss.cached_dataset.CachedSimulatedDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning tries to add the correct sampler for distributed and arbitrary hardware
There is no need to set it yourself.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code> or a sequence of them specifying prediction samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.cached_dataset.CachedSimulatedDataModule.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#CachedSimulatedDataModule.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.CachedSimulatedDataModule.setup" title="Link to this definition"></a></dt>
<dd><p>Called at the beginning of fit (train + validate), validate, test, or predict. This is a good hook when you
need to build models dynamically or adjust something about them. This hook is called on every process when
using DDP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stage</strong> – either <code class="docutils literal notranslate"><span class="pre">'fit'</span></code>, <code class="docutils literal notranslate"><span class="pre">'validate'</span></code>, <code class="docutils literal notranslate"><span class="pre">'test'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'predict'</span></code></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LitModel</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">()</span>
        <span class="n">tokenize</span><span class="p">()</span>

        <span class="c1"># don&#39;t do this</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">something</span> <span class="o">=</span> <span class="k">else</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stage</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">num_classes</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.cached_dataset.CachedSimulatedDataModule.test_dataloader">
<span class="sig-name descname"><span class="pre">test_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#CachedSimulatedDataModule.test_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.CachedSimulatedDataModule.test_dataloader" title="Link to this definition"></a></dt>
<dd><p>An iterable or collection of iterables specifying test samples.</p>
<p>For more information about multiple dataloaders, see this <a class="reference external" href="https://lightning.ai/docs/pytorch/stable/data/iterables.html#multiple-dataloaders" title="(in PyTorch Lightning v2.6.0)"><span class="xref std std-ref">section</span></a>.</p>
<p>For data processing use the following pattern:</p>
<blockquote>
<div><ul class="simple">
<li><p>download in <code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></p></li>
<li><p>process and split in <a class="reference internal" href="#bliss.cached_dataset.CachedSimulatedDataModule.setup" title="bliss.cached_dataset.CachedSimulatedDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
</div></blockquote>
<p>However, the above are only necessary for distributed processing.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>do not assign state in prepare_data</p>
</div>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">test()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></p></li>
<li><p><a class="reference internal" href="#bliss.cached_dataset.CachedSimulatedDataModule.setup" title="bliss.cached_dataset.CachedSimulatedDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning tries to add the correct sampler for distributed and arbitrary hardware.
There is no need to set it yourself.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t need a test dataset and a <code class="xref py py-meth docutils literal notranslate"><span class="pre">test_step()</span></code>, you don’t need to implement
this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.cached_dataset.CachedSimulatedDataModule.train_dataloader">
<span class="sig-name descname"><span class="pre">train_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#CachedSimulatedDataModule.train_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.CachedSimulatedDataModule.train_dataloader" title="Link to this definition"></a></dt>
<dd><p>An iterable or collection of iterables specifying training samples.</p>
<p>For more information about multiple dataloaders, see this <a class="reference external" href="https://lightning.ai/docs/pytorch/stable/data/iterables.html#multiple-dataloaders" title="(in PyTorch Lightning v2.6.0)"><span class="xref std std-ref">section</span></a>.</p>
<p>The dataloader you return will not be reloaded unless you set
<a href="#id1"><span class="problematic" id="id2">:paramref:`~pytorch_lightning.trainer.trainer.Trainer.reload_dataloaders_every_n_epochs`</span></a> to
a positive integer.</p>
<p>For data processing use the following pattern:</p>
<blockquote>
<div><ul class="simple">
<li><p>download in <code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></p></li>
<li><p>process and split in <a class="reference internal" href="#bliss.cached_dataset.CachedSimulatedDataModule.setup" title="bliss.cached_dataset.CachedSimulatedDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
</div></blockquote>
<p>However, the above are only necessary for distributed processing.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>do not assign state in prepare_data</p>
</div>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></p></li>
<li><p><a class="reference internal" href="#bliss.cached_dataset.CachedSimulatedDataModule.setup" title="bliss.cached_dataset.CachedSimulatedDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning tries to add the correct sampler for distributed and arbitrary hardware.
There is no need to set it yourself.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.cached_dataset.CachedSimulatedDataModule.val_dataloader">
<span class="sig-name descname"><span class="pre">val_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#CachedSimulatedDataModule.val_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.CachedSimulatedDataModule.val_dataloader" title="Link to this definition"></a></dt>
<dd><p>An iterable or collection of iterables specifying validation samples.</p>
<p>For more information about multiple dataloaders, see this <a class="reference external" href="https://lightning.ai/docs/pytorch/stable/data/iterables.html#multiple-dataloaders" title="(in PyTorch Lightning v2.6.0)"><span class="xref std std-ref">section</span></a>.</p>
<p>The dataloader you return will not be reloaded unless you set
<a href="#id3"><span class="problematic" id="id4">:paramref:`~pytorch_lightning.trainer.trainer.Trainer.reload_dataloaders_every_n_epochs`</span></a> to
a positive integer.</p>
<p>It’s recommended that all data downloads and preparation happen in <code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code>.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">validate()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></p></li>
<li><p><a class="reference internal" href="#bliss.cached_dataset.CachedSimulatedDataModule.setup" title="bliss.cached_dataset.CachedSimulatedDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning tries to add the correct sampler for distributed and arbitrary hardware
There is no need to set it yourself.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t need a validation dataset and a <code class="xref py py-meth docutils literal notranslate"><span class="pre">validation_step()</span></code>, you don’t need to
implement this method.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.cached_dataset.ChunkingDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.cached_dataset.</span></span><span class="sig-name descname"><span class="pre">ChunkingDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#ChunkingDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.ChunkingDataset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.cached_dataset.ChunkingSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.cached_dataset.</span></span><span class="sig-name descname"><span class="pre">ChunkingSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#ChunkingSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.ChunkingSampler" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.cached_dataset.DistributedChunkingSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.cached_dataset.</span></span><span class="sig-name descname"><span class="pre">DistributedChunkingSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_replicas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#DistributedChunkingSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.DistributedChunkingSampler" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.cached_dataset.FluxFilterTransform">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.cached_dataset.</span></span><span class="sig-name descname"><span class="pre">FluxFilterTransform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_flux</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#FluxFilterTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.FluxFilterTransform" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.cached_dataset.FullCatalogToTileTransform">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.cached_dataset.</span></span><span class="sig-name descname"><span class="pre">FullCatalogToTileTransform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile_slen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_oob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#FullCatalogToTileTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.FullCatalogToTileTransform" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.cached_dataset.OneBandTransform">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.cached_dataset.</span></span><span class="sig-name descname"><span class="pre">OneBandTransform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/cached_dataset.html#OneBandTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.cached_dataset.OneBandTransform" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="bliss-align-module">
<h3>bliss.align module<a class="headerlink" href="#bliss-align-module" title="Link to this heading"></a></h3>
<p>Image alignment utilities for multi-band reprojection.</p>
<dl class="py function" id="module-bliss.align">
<dt class="sig sig-object py" id="bliss.align.align">
<span class="sig-prename descclassname"><span class="pre">bliss.align.</span></span><span class="sig-name descname"><span class="pre">align</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_band</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/bliss/align.html#align"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.align.align" title="Link to this definition"></a></dt>
<dd><p>Reproject images based on some reference WCS for pixel alignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> – 4D array of shape (coadd_depth, n_bands, h, w)</p></li>
<li><p><strong>wcs_list</strong> – list of lists, wcs_list[d][b] is the WCS for depth d, band b</p></li>
<li><p><strong>ref_band</strong> – reference band for alignment</p></li>
<li><p><strong>ref_depth</strong> – reference depth for alignment</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reprojected images as 4D array of shape (coadd_depth, n_bands, h, w)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="bliss-data-augmentation-module">
<h3>bliss.data_augmentation module<a class="headerlink" href="#bliss-data-augmentation-module" title="Link to this heading"></a></h3>
<p>Data augmentation transforms for training.</p>
<dl class="py class" id="module-bliss.data_augmentation">
<dt class="sig sig-object py" id="bliss.data_augmentation.RandomShiftTransform">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.data_augmentation.</span></span><span class="sig-name descname"><span class="pre">RandomShiftTransform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile_slen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sources_per_tile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/data_augmentation.html#RandomShiftTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.data_augmentation.RandomShiftTransform" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.data_augmentation.RotateFlipTransform">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.data_augmentation.</span></span><span class="sig-name descname"><span class="pre">RotateFlipTransform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/data_augmentation.html#RotateFlipTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.data_augmentation.RotateFlipTransform" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="bliss-global-env-module">
<h3>bliss.global_env module<a class="headerlink" href="#bliss-global-env-module" title="Link to this heading"></a></h3>
<p>Global environment variables for distributed training.</p>
</section>
</section>
<section id="encoder-package">
<span id="module-bliss.global_env"></span><h2>Encoder Package<a class="headerlink" href="#encoder-package" title="Link to this heading"></a></h2>
<p>Neural network components for variational inference.</p>
<section id="bliss-encoder-encoder-module">
<span id="module-bliss.encoder"></span><h3>bliss.encoder.encoder module<a class="headerlink" href="#bliss-encoder-encoder-module" title="Link to this heading"></a></h3>
<p>Main Encoder class implementing the neural posterior estimator.</p>
<dl class="py class" id="module-bliss.encoder.encoder">
<dt class="sig sig-object py" id="bliss.encoder.encoder.Encoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.encoder.</span></span><span class="sig-name descname"><span class="pre">Encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">survey_bands</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_slen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_normalizers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_dist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bliss.encoder.variational_dist.VariationalDist" title="bliss.encoder.variational_dist.VariationalDist"><span class="pre">VariationalDist</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">matcher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CatalogMatcher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_image_renders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricCollection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricCollection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricCollection</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_double_detect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_checkerboard</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sampler_colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_band</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_mode_not_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimalist_conditioning</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">any_order_training</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/encoder.html#Encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.encoder.Encoder" title="Link to this definition"></a></dt>
<dd><p>Encodes the distribution of a latent variable representing an astronomical image.</p>
<p>This class implements the source encoder, which is supposed to take in
an astronomical image of size slen * slen and returns a NN latent variable
representation of this image.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.encoder.Encoder.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/encoder.html#Encoder.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.encoder.Encoder.configure_optimizers" title="Link to this definition"></a></dt>
<dd><p>Configure optimizers for training (pytorch lightning).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.encoder.Encoder.on_fit_start">
<span class="sig-name descname"><span class="pre">on_fit_start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/encoder.html#Encoder.on_fit_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.encoder.Encoder.on_fit_start" title="Link to this definition"></a></dt>
<dd><p>Called at the very beginning of fit.</p>
<p>If on DDP it is called on every process</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.encoder.Encoder.on_test_epoch_end">
<span class="sig-name descname"><span class="pre">on_test_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/encoder.html#Encoder.on_test_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.encoder.Encoder.on_test_epoch_end" title="Link to this definition"></a></dt>
<dd><p>Called in the test loop at the very end of the epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.encoder.Encoder.on_train_epoch_start">
<span class="sig-name descname"><span class="pre">on_train_epoch_start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/encoder.html#Encoder.on_train_epoch_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.encoder.Encoder.on_train_epoch_start" title="Link to this definition"></a></dt>
<dd><p>Called in the training loop at the very beginning of the epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.encoder.Encoder.on_validation_epoch_end">
<span class="sig-name descname"><span class="pre">on_validation_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/encoder.html#Encoder.on_validation_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.encoder.Encoder.on_validation_epoch_end" title="Link to this definition"></a></dt>
<dd><p>Called in the validation loop at the very end of the epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.encoder.Encoder.predict_step">
<span class="sig-name descname"><span class="pre">predict_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/encoder.html#Encoder.predict_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.encoder.Encoder.predict_step" title="Link to this definition"></a></dt>
<dd><p>Pytorch lightning method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.encoder.Encoder.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/encoder.html#Encoder.test_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.encoder.Encoder.test_step" title="Link to this definition"></a></dt>
<dd><p>Pytorch lightning method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.encoder.Encoder.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/encoder.html#Encoder.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.encoder.Encoder.training_step" title="Link to this definition"></a></dt>
<dd><p>Training step (pytorch lightning).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.encoder.Encoder.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/encoder.html#Encoder.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.encoder.Encoder.validation_step" title="Link to this definition"></a></dt>
<dd><p>Pytorch lightning method.</p>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-encoder-variational-dist-module">
<h3>bliss.encoder.variational_dist module<a class="headerlink" href="#bliss-encoder-variational-dist-module" title="Link to this heading"></a></h3>
<p>Variational distribution factors for different latent variables.</p>
<dl class="py class" id="module-bliss.encoder.variational_dist">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.DiscretizedUnitBox">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">DiscretizedUnitBox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#DiscretizedUnitBox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.DiscretizedUnitBox" title="Link to this definition"></a></dt>
<dd><p>A continuous bivariate distribution over the 2d unit box, with a discretized density.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.DiscretizedUnitBox.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#DiscretizedUnitBox.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.DiscretizedUnitBox.log_prob" title="Link to this definition"></a></dt>
<dd><p>Returns the log of the probability density/mass function evaluated at
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Tensor</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.DiscretizedUnitBox.mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mode</span></span><a class="headerlink" href="#bliss.encoder.variational_dist.DiscretizedUnitBox.mode" title="Link to this definition"></a></dt>
<dd><p>Returns the mode of the distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.DiscretizedUnitBox.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#DiscretizedUnitBox.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.DiscretizedUnitBox.sample" title="Link to this definition"></a></dt>
<dd><p>Generates a sample_shape shaped sample or sample_shape shaped batch of
samples if the distribution parameters are batched.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.GalaxyGating">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">GalaxyGating</span></span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#GalaxyGating"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.GalaxyGating" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.LogNormalEpsilon">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">LogNormalEpsilon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#LogNormalEpsilon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.LogNormalEpsilon" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.LogNormalEpsilon.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#LogNormalEpsilon.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.LogNormalEpsilon.log_prob" title="Link to this definition"></a></dt>
<dd><p>Scores the sample by inverting the transform(s) and computing the score
using the score of the base distribution and the log abs det jacobian.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.LogNormalEpsilon.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#LogNormalEpsilon.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.LogNormalEpsilon.sample" title="Link to this definition"></a></dt>
<dd><p>Generates a sample_shape shaped sample or sample_shape shaped batch of
samples if the distribution parameters are batched. Samples first from
base distribution and applies <cite>transform()</cite> for every transform in the
list.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.NllGating">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">NllGating</span></span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#NllGating"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.NllGating" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.NullGating">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">NullGating</span></span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#NullGating"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.NullGating" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.RescaledLogitNormal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">RescaledLogitNormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#RescaledLogitNormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.RescaledLogitNormal" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.RescaledLogitNormal.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#RescaledLogitNormal.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.RescaledLogitNormal.log_prob" title="Link to this definition"></a></dt>
<dd><p>Returns the log of the probability density/mass function evaluated at
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Tensor</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.RescaledLogitNormal.mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mode</span></span><a class="headerlink" href="#bliss.encoder.variational_dist.RescaledLogitNormal.mode" title="Link to this definition"></a></dt>
<dd><p>Returns the mode of the distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.RescaledLogitNormal.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#RescaledLogitNormal.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.RescaledLogitNormal.sample" title="Link to this definition"></a></dt>
<dd><p>Generates a sample_shape shaped sample or sample_shape shaped batch of
samples if the distribution parameters are batched.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.SourcesGating">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">SourcesGating</span></span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#SourcesGating"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.SourcesGating" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.StarGating">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">StarGating</span></span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#StarGating"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.StarGating" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.TDBNFactor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">TDBNFactor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_clamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_clamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#TDBNFactor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.TDBNFactor" title="Link to this definition"></a></dt>
<dd><p>Produces truncated bivariate normal distributions from unconstrained parameters.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.TruncatedDiagonalMVN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">TruncatedDiagonalMVN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#TruncatedDiagonalMVN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.TruncatedDiagonalMVN" title="Link to this definition"></a></dt>
<dd><p>A truncated diagonal multivariate normal distribution.</p>
<dl class="py property">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.TruncatedDiagonalMVN.batch_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_shape</span></span><a class="headerlink" href="#bliss.encoder.variational_dist.TruncatedDiagonalMVN.batch_shape" title="Link to this definition"></a></dt>
<dd><p>Returns the shape over which parameters are batched.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.TruncatedDiagonalMVN.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#TruncatedDiagonalMVN.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.TruncatedDiagonalMVN.cdf" title="Link to this definition"></a></dt>
<dd><p>Returns the cumulative density/mass function evaluated at
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Tensor</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.TruncatedDiagonalMVN.event_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">event_shape</span></span><a class="headerlink" href="#bliss.encoder.variational_dist.TruncatedDiagonalMVN.event_shape" title="Link to this definition"></a></dt>
<dd><p>Returns the shape of a single sample (without batching).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.TruncatedDiagonalMVN.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#TruncatedDiagonalMVN.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.TruncatedDiagonalMVN.log_prob" title="Link to this definition"></a></dt>
<dd><p>Returns the log of the probability density/mass function evaluated at
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Tensor</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.TruncatedDiagonalMVN.mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean</span></span><a class="headerlink" href="#bliss.encoder.variational_dist.TruncatedDiagonalMVN.mean" title="Link to this definition"></a></dt>
<dd><p>Returns the mean of the distribution.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.TruncatedDiagonalMVN.mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mode</span></span><a class="headerlink" href="#bliss.encoder.variational_dist.TruncatedDiagonalMVN.mode" title="Link to this definition"></a></dt>
<dd><p>Returns the mode of the distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.TruncatedDiagonalMVN.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#TruncatedDiagonalMVN.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.TruncatedDiagonalMVN.sample" title="Link to this definition"></a></dt>
<dd><p>Generate sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample_shape</strong> (<em>Tuple</em>) – Shape of samples to draw</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(sample_shape, self.batch_shape, self.event_shape) shaped sample</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.TruncatedDiagonalMVN.stddev">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stddev</span></span><a class="headerlink" href="#bliss.encoder.variational_dist.TruncatedDiagonalMVN.stddev" title="Link to this definition"></a></dt>
<dd><p>Returns the standard deviation of the distribution.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.variational_dist.VariationalDist">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.variational_dist.</span></span><span class="sig-name descname"><span class="pre">VariationalDist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_slen</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/variational_dist.html#VariationalDist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.variational_dist.VariationalDist" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="bliss-encoder-metrics-module">
<h3>bliss.encoder.metrics module<a class="headerlink" href="#bliss-encoder-metrics-module" title="Link to this heading"></a></h3>
<p>Evaluation metrics for detection, classification, and flux estimation.</p>
<dl class="py class" id="module-bliss.encoder.metrics">
<dt class="sig sig-object py" id="bliss.encoder.metrics.CatFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.metrics.</span></span><span class="sig-name descname"><span class="pre">CatFilter</span></span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#CatFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.CatFilter" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.CatFilter.get_cur_filter_bools">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_cur_filter_bools</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_cat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#CatFilter.get_cur_filter_bools"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.CatFilter.get_cur_filter_bools" title="Link to this definition"></a></dt>
<dd><p>Get filter bools.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.CatFilter.get_cur_postfix">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_cur_postfix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#CatFilter.get_cur_postfix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.CatFilter.get_cur_postfix" title="Link to this definition"></a></dt>
<dd><p>Get postfix for the output metric name.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.metrics.DetectionPerformance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.metrics.</span></span><span class="sig-name descname"><span class="pre">DetectionPerformance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_flux_bin_cutoffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_zero_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_band</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_bin_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'flux'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_last_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bliss.encoder.metrics.CatFilter" title="bliss.encoder.metrics.CatFilter"><span class="pre">CatFilter</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#DetectionPerformance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.DetectionPerformance" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.DetectionPerformance.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#DetectionPerformance.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.DetectionPerformance.compute" title="Link to this definition"></a></dt>
<dd><p>Override this method to compute the final metric value.</p>
<p>This method will automatically synchronize state variables when running in distributed backend.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.DetectionPerformance.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#DetectionPerformance.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.DetectionPerformance.update" title="Link to this definition"></a></dt>
<dd><p>Override this method to update the state variables of your metric class.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.metrics.FluxBinMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.metrics.</span></span><span class="sig-name descname"><span class="pre">FluxBinMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_flux_bin_cutoffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_zero_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_bin_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_last_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#FluxBinMetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.FluxBinMetric" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.metrics.FluxBinMetricWithFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.metrics.</span></span><span class="sig-name descname"><span class="pre">FluxBinMetricWithFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_flux_bin_cutoffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_zero_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_bin_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_last_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bliss.encoder.metrics.CatFilter" title="bliss.encoder.metrics.CatFilter"><span class="pre">CatFilter</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#FluxBinMetricWithFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.FluxBinMetricWithFilter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.metrics.FluxError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.metrics.</span></span><span class="sig-name descname"><span class="pre">FluxError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">survey_bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_flux_bin_cutoffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_zero_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_band</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_bin_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_last_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#FluxError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.FluxError" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.FluxError.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#FluxError.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.FluxError.compute" title="Link to this definition"></a></dt>
<dd><p>Override this method to compute the final metric value.</p>
<p>This method will automatically synchronize state variables when running in distributed backend.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.FluxError.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#FluxError.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.FluxError.update" title="Link to this definition"></a></dt>
<dd><p>Override this method to update the state variables of your metric class.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.metrics.GalaxyShapeError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.metrics.</span></span><span class="sig-name descname"><span class="pre">GalaxyShapeError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_flux_bin_cutoffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_zero_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_bin_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_last_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#GalaxyShapeError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.GalaxyShapeError" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.GalaxyShapeError.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#GalaxyShapeError.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.GalaxyShapeError.compute" title="Link to this definition"></a></dt>
<dd><p>Override this method to compute the final metric value.</p>
<p>This method will automatically synchronize state variables when running in distributed backend.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.GalaxyShapeError.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#GalaxyShapeError.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.GalaxyShapeError.update" title="Link to this definition"></a></dt>
<dd><p>Override this method to update the state variables of your metric class.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.metrics.GeneralBinMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.metrics.</span></span><span class="sig-name descname"><span class="pre">GeneralBinMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bin_cutoffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_last_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#GeneralBinMetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.GeneralBinMetric" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.metrics.NullFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.metrics.</span></span><span class="sig-name descname"><span class="pre">NullFilter</span></span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#NullFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.NullFilter" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.NullFilter.get_cur_filter_bools">
<span class="sig-name descname"><span class="pre">get_cur_filter_bools</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_cat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#NullFilter.get_cur_filter_bools"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.NullFilter.get_cur_filter_bools" title="Link to this definition"></a></dt>
<dd><p>Get filter bools.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.NullFilter.get_cur_postfix">
<span class="sig-name descname"><span class="pre">get_cur_postfix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#NullFilter.get_cur_postfix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.NullFilter.get_cur_postfix" title="Link to this definition"></a></dt>
<dd><p>Get postfix for the output metric name.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.metrics.SourceTypeAccuracy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.metrics.</span></span><span class="sig-name descname"><span class="pre">SourceTypeAccuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_flux_bin_cutoffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_zero_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_band</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_bin_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'flux'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_last_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bliss.encoder.metrics.CatFilter" title="bliss.encoder.metrics.CatFilter"><span class="pre">CatFilter</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#SourceTypeAccuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.SourceTypeAccuracy" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.SourceTypeAccuracy.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#SourceTypeAccuracy.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.SourceTypeAccuracy.compute" title="Link to this definition"></a></dt>
<dd><p>Override this method to compute the final metric value.</p>
<p>This method will automatically synchronize state variables when running in distributed backend.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.SourceTypeAccuracy.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#SourceTypeAccuracy.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.SourceTypeAccuracy.update" title="Link to this definition"></a></dt>
<dd><p>Override this method to update the state variables of your metric class.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.metrics.SourceTypeFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.metrics.</span></span><span class="sig-name descname"><span class="pre">SourceTypeFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#SourceTypeFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.SourceTypeFilter" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.SourceTypeFilter.get_cur_filter_bools">
<span class="sig-name descname"><span class="pre">get_cur_filter_bools</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_cat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#SourceTypeFilter.get_cur_filter_bools"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.SourceTypeFilter.get_cur_filter_bools" title="Link to this definition"></a></dt>
<dd><p>Get filter bools.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.metrics.SourceTypeFilter.get_cur_postfix">
<span class="sig-name descname"><span class="pre">get_cur_postfix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/metrics.html#SourceTypeFilter.get_cur_postfix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.metrics.SourceTypeFilter.get_cur_postfix" title="Link to this definition"></a></dt>
<dd><p>Get postfix for the output metric name.</p>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-encoder-convnets-module">
<h3>bliss.encoder.convnets module<a class="headerlink" href="#bliss-encoder-convnets-module" title="Link to this heading"></a></h3>
<p>Feature extraction neural networks.</p>
<dl class="py class" id="module-bliss.encoder.convnets">
<dt class="sig sig-object py" id="bliss.encoder.convnets.FeaturesNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.convnets.</span></span><span class="sig-name descname"><span class="pre">FeaturesNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch_per_band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double_downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/convnets.html#FeaturesNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.convnets.FeaturesNet" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.convnets.FeaturesNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/convnets.html#FeaturesNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.convnets.FeaturesNet.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-encoder-convnet-layers-module">
<h3>bliss.encoder.convnet_layers module<a class="headerlink" href="#bliss-encoder-convnet-layers-module" title="Link to this heading"></a></h3>
<p>Building blocks for convolutional networks.</p>
<dl class="py class" id="module-bliss.encoder.convnet_layers">
<dt class="sig sig-object py" id="bliss.encoder.convnet_layers.Bottleneck">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.convnet_layers.</span></span><span class="sig-name descname"><span class="pre">Bottleneck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/convnet_layers.html#Bottleneck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.convnet_layers.Bottleneck" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.convnet_layers.Bottleneck.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/convnet_layers.html#Bottleneck.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.convnet_layers.Bottleneck.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.convnet_layers.C3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.convnet_layers.</span></span><span class="sig-name descname"><span class="pre">C3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/convnet_layers.html#C3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.convnet_layers.C3" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.convnet_layers.C3.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/convnet_layers.html#C3.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.convnet_layers.C3.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.convnet_layers.ConvBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.convnet_layers.</span></span><span class="sig-name descname"><span class="pre">ConvBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/convnet_layers.html#ConvBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.convnet_layers.ConvBlock" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.convnet_layers.ConvBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/convnet_layers.html#ConvBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.convnet_layers.ConvBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.convnet_layers.Detect">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.convnet_layers.</span></span><span class="sig-name descname"><span class="pre">Detect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/convnet_layers.html#Detect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.convnet_layers.Detect" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.convnet_layers.Detect.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/convnet_layers.html#Detect.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.convnet_layers.Detect.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-encoder-image-normalizer-module">
<h3>bliss.encoder.image_normalizer module<a class="headerlink" href="#bliss-encoder-image-normalizer-module" title="Link to this heading"></a></h3>
<p>Image normalization strategies (CLAHE, asinh, PSF).</p>
<dl class="py class" id="module-bliss.encoder.image_normalizer">
<dt class="sig sig-object py" id="bliss.encoder.image_normalizer.AsinhQuantileNormalizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.image_normalizer.</span></span><span class="sig-name descname"><span class="pre">AsinhQuantileNormalizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/image_normalizer.html#AsinhQuantileNormalizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.image_normalizer.AsinhQuantileNormalizer" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.image_normalizer.AsinhQuantileNormalizer.num_channels_per_band">
<span class="sig-name descname"><span class="pre">num_channels_per_band</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/image_normalizer.html#AsinhQuantileNormalizer.num_channels_per_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.image_normalizer.AsinhQuantileNormalizer.num_channels_per_band" title="Link to this definition"></a></dt>
<dd><p>Number of input channels for model based on this input normalizer.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.image_normalizer.ClaheNormalizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.image_normalizer.</span></span><span class="sig-name descname"><span class="pre">ClaheNormalizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_stdev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/image_normalizer.html#ClaheNormalizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.image_normalizer.ClaheNormalizer" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.image_normalizer.ClaheNormalizer.get_input_tensor">
<span class="sig-name descname"><span class="pre">get_input_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/image_normalizer.html#ClaheNormalizer.get_input_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.image_normalizer.ClaheNormalizer.get_input_tensor" title="Link to this definition"></a></dt>
<dd><p>Perform Contrast Limited Adaptive Histogram Equalization (CLAHE) on input images.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.image_normalizer.ClaheNormalizer.num_channels_per_band">
<span class="sig-name descname"><span class="pre">num_channels_per_band</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/image_normalizer.html#ClaheNormalizer.num_channels_per_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.image_normalizer.ClaheNormalizer.num_channels_per_band" title="Link to this definition"></a></dt>
<dd><p>Number of input channels for model based on this input normalizer.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.image_normalizer.NullNormalizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.image_normalizer.</span></span><span class="sig-name descname"><span class="pre">NullNormalizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/image_normalizer.html#NullNormalizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.image_normalizer.NullNormalizer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.encoder.image_normalizer.PsfAsImage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.image_normalizer.</span></span><span class="sig-name descname"><span class="pre">PsfAsImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_psf_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/image_normalizer.html#PsfAsImage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.image_normalizer.PsfAsImage" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.image_normalizer.PsfAsImage.num_channels_per_band">
<span class="sig-name descname"><span class="pre">num_channels_per_band</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/image_normalizer.html#PsfAsImage.num_channels_per_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.image_normalizer.PsfAsImage.num_channels_per_band" title="Link to this definition"></a></dt>
<dd><p>Number of input channels for model based on this input normalizer.</p>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-encoder-sample-image-renders-module">
<h3>bliss.encoder.sample_image_renders module<a class="headerlink" href="#bliss-encoder-sample-image-renders-module" title="Link to this heading"></a></h3>
<p>Visualization utilities for sample predictions.</p>
<dl class="py class" id="module-bliss.encoder.sample_image_renders">
<dt class="sig sig-object py" id="bliss.encoder.sample_image_renders.PlotSampleImages">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.encoder.sample_image_renders.</span></span><span class="sig-name descname"><span class="pre">PlotSampleImages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tiles_to_crop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_slen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/sample_image_renders.html#PlotSampleImages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.sample_image_renders.PlotSampleImages" title="Link to this definition"></a></dt>
<dd><p>Metric wrapper for plotting sample images.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.sample_image_renders.PlotSampleImages.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/sample_image_renders.html#PlotSampleImages.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.sample_image_renders.PlotSampleImages.compute" title="Link to this definition"></a></dt>
<dd><p>Override this method to compute the final metric value.</p>
<p>This method will automatically synchronize state variables when running in distributed backend.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.sample_image_renders.PlotSampleImages.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/sample_image_renders.html#PlotSampleImages.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.sample_image_renders.PlotSampleImages.plot" title="Link to this definition"></a></dt>
<dd><p>Override this method plot the metric value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.encoder.sample_image_renders.PlotSampleImages.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_cat_cropped</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_with_mode_tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_with_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/sample_image_renders.html#PlotSampleImages.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.sample_image_renders.PlotSampleImages.update" title="Link to this definition"></a></dt>
<dd><p>Override this method to update the state variables of your metric class.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bliss.encoder.sample_image_renders.plot_detections">
<span class="sig-prename descclassname"><span class="pre">bliss.encoder.sample_image_renders.</span></span><span class="sig-name descname"><span class="pre">plot_detections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin_px</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/sample_image_renders.html#plot_detections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.sample_image_renders.plot_detections" title="Link to this definition"></a></dt>
<dd><p>Plots an image of true and estimated sources.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bliss.encoder.sample_image_renders.plot_plocs">
<span class="sig-prename descclassname"><span class="pre">bliss.encoder.sample_image_renders.</span></span><span class="sig-name descname"><span class="pre">plot_plocs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">catalog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/encoder/sample_image_renders.html#plot_plocs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.encoder.sample_image_renders.plot_plocs" title="Link to this definition"></a></dt>
<dd><p>Plots pixel coordinates of sources on given axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>catalog</strong> – FullCatalog to get sources from</p></li>
<li><p><strong>ax</strong> – Matplotlib axes to plot on</p></li>
<li><p><strong>idx</strong> – index of the image in the batch to plot sources of</p></li>
<li><p><strong>filter_by</strong> – Which sources to plot. Can be either a string specifying the source type (either
‘galaxy’, ‘star’, or ‘all’), or a list of indices. Defaults to “all”.</p></li>
<li><p><strong>bp</strong> – Offset added to locations, used for adjusting for cropped tiles. Defaults to 0.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments to pass to scatter plot.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.14)"><strong>NotImplementedError</strong></a> – If object_type is not one of ‘galaxy’, ‘star’, ‘all’, or a List.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="surveys-package">
<h2>Surveys Package<a class="headerlink" href="#surveys-package" title="Link to this heading"></a></h2>
<p>Survey-specific data loaders and utilities.</p>
<section id="bliss-surveys-survey-module">
<span id="module-bliss.surveys"></span><h3>bliss.surveys.survey module<a class="headerlink" href="#bliss-surveys-survey-module" title="Link to this heading"></a></h3>
<p>Base class for survey implementations.</p>
<dl class="py class" id="module-bliss.surveys.survey">
<dt class="sig sig-object py" id="bliss.surveys.survey.Survey">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.survey.</span></span><span class="sig-name descname"><span class="pre">Survey</span></span><a class="reference internal" href="../_modules/bliss/surveys/survey.html#Survey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.survey.Survey" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.survey.Survey.coadd_images">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coadd_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">constituent_images</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/survey.html#Survey.coadd_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.survey.Survey.coadd_images" title="Link to this definition"></a></dt>
<dd><p>Coadd the constituent images into a single image.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.survey.Survey.idx">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/survey.html#Survey.idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.survey.Survey.idx" title="Link to this definition"></a></dt>
<dd><p>Return the index for the given image_id.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.survey.Survey.image_id">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">image_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/survey.html#Survey.image_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.survey.Survey.image_id" title="Link to this definition"></a></dt>
<dd><p>Return the image_id for the given index.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.survey.Survey.image_ids">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">image_ids</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></span><a class="reference internal" href="../_modules/bliss/surveys/survey.html#Survey.image_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.survey.Survey.image_ids" title="Link to this definition"></a></dt>
<dd><p>Return a list of all image_ids.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.survey.Survey.predict_dataloader">
<span class="sig-name descname"><span class="pre">predict_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/survey.html#Survey.predict_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.survey.Survey.predict_dataloader" title="Link to this definition"></a></dt>
<dd><p>Return a DataLoader for prediction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.survey.Survey.prepare_data">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/survey.html#Survey.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.survey.Survey.prepare_data" title="Link to this definition"></a></dt>
<dd><p>pl.LightningDataModule override.</p>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-surveys-sdss-module">
<h3>bliss.surveys.sdss module<a class="headerlink" href="#bliss-surveys-sdss-module" title="Link to this heading"></a></h3>
<p>Sloan Digital Sky Survey data loader.</p>
<dl class="py class" id="module-bliss.surveys.sdss">
<dt class="sig sig-object py" id="bliss.surveys.sdss.PhotoFullCatalog">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.sdss.</span></span><span class="sig-name descname"><span class="pre">PhotoFullCatalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#PhotoFullCatalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.PhotoFullCatalog" title="Link to this definition"></a></dt>
<dd><p>Class for the SDSS PHOTO Catalog.</p>
<p>Some resources:
- <a class="reference external" href="https://www.sdss.org/dr12/algorithms/classify/">https://www.sdss.org/dr12/algorithms/classify/</a>
- <a class="reference external" href="https://www.sdss.org/dr12/algorithms/resolve/">https://www.sdss.org/dr12/algorithms/resolve/</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.sdss.PhotoFullCatalog.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cat_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">WCS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#PhotoFullCatalog.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.PhotoFullCatalog.from_file" title="Link to this definition"></a></dt>
<dd><p>Instantiates PhotoFullCatalog with RCF and WCS information from disk.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.sdss.PhotoFullCatalog.restrict_by_ra_dec">
<span class="sig-name descname"><span class="pre">restrict_by_ra_dec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra_lim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_lim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#PhotoFullCatalog.restrict_by_ra_dec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.PhotoFullCatalog.restrict_by_ra_dec" title="Link to this definition"></a></dt>
<dd><p>Helper function to restrict photo catalog to within RA and DEC limits.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.surveys.sdss.SDSSDownloader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.sdss.</span></span><span class="sig-name descname"><span class="pre">SDSSDownloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#SDSSDownloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.SDSSDownloader" title="Link to this definition"></a></dt>
<dd><p>Class for downloading SDSS data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.sdss.SDSSDownloader.field_extents">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">field_extents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Table</span></span></span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#SDSSDownloader.field_extents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.SDSSDownloader.field_extents" title="Link to this definition"></a></dt>
<dd><p>Get field extents table.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.surveys.sdss.SloanDigitalSkySurvey">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.sdss.</span></span><span class="sig-name descname"><span class="pre">SloanDigitalSkySurvey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psf_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bliss.simulator.psf.PSFConfig" title="bliss.simulator.psf.PSFConfig"><span class="pre">PSFConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data/sdss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_image_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_to_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_to_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_to_hw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#SloanDigitalSkySurvey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.SloanDigitalSkySurvey" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.sdss.SloanDigitalSkySurvey.idx">
<span class="sig-name descname"><span class="pre">idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#SloanDigitalSkySurvey.idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.SloanDigitalSkySurvey.idx" title="Link to this definition"></a></dt>
<dd><p>Return the index for the given image_id.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.sdss.SloanDigitalSkySurvey.image_id">
<span class="sig-name descname"><span class="pre">image_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#SloanDigitalSkySurvey.image_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.SloanDigitalSkySurvey.image_id" title="Link to this definition"></a></dt>
<dd><p>Return the image_id for the given index.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.sdss.SloanDigitalSkySurvey.image_ids">
<span class="sig-name descname"><span class="pre">image_ids</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#SloanDigitalSkySurvey.image_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.SloanDigitalSkySurvey.image_ids" title="Link to this definition"></a></dt>
<dd><p>Return all image_ids.</p>
<p>Note: Parallel to <cite>rcfgcs</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of (run, camcol, field) image_ids.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[Tuple[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.sdss.SloanDigitalSkySurvey.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#SloanDigitalSkySurvey.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.SloanDigitalSkySurvey.prepare_data" title="Link to this definition"></a></dt>
<dd><p>pl.LightningDataModule override.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.sdss.SloanDigitalSkySurvey.radec_for_rcf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">radec_for_rcf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camcol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#SloanDigitalSkySurvey.radec_for_rcf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.SloanDigitalSkySurvey.radec_for_rcf" title="Link to this definition"></a></dt>
<dd><p>Get center (RA, DEC) for a given run, camcol, field.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.sdss.SloanDigitalSkySurvey.rcf_for_radec">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rcf_for_radec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/bliss/surveys/sdss.html#SloanDigitalSkySurvey.rcf_for_radec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.sdss.SloanDigitalSkySurvey.rcf_for_radec" title="Link to this definition"></a></dt>
<dd><p>Get run, camcol, field for a given RA, DEC.</p>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-surveys-des-module">
<h3>bliss.surveys.des module<a class="headerlink" href="#bliss-surveys-des-module" title="Link to this heading"></a></h3>
<p>Dark Energy Survey data loader.</p>
<dl class="py attribute" id="module-bliss.surveys.des">
<dt class="sig sig-object py" id="bliss.surveys.des.DES">
<span class="sig-prename descclassname"><span class="pre">bliss.surveys.des.</span></span><span class="sig-name descname"><span class="pre">DES</span></span><a class="headerlink" href="#bliss.surveys.des.DES" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#bliss.surveys.des.DarkEnergySurvey" title="bliss.surveys.des.DarkEnergySurvey"><code class="xref py py-class docutils literal notranslate"><span class="pre">DarkEnergySurvey</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.surveys.des.DESDownloader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.des.</span></span><span class="sig-name descname"><span class="pre">DESDownloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bliss.surveys.des.DESImageID" title="bliss.surveys.des.DESImageID"><span class="pre">DESImageID</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DESDownloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DESDownloader" title="Link to this definition"></a></dt>
<dd><p>Class for downloading DECaLS data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DESDownloader.download_background">
<span class="sig-name descname"><span class="pre">download_background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">brickname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_filename_no_ext</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DESDownloader.download_background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DESDownloader.download_background" title="Link to this definition"></a></dt>
<dd><p>Download sky params for specified band, for this brick/ccd.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DESDownloader.download_backgrounds">
<span class="sig-name descname"><span class="pre">download_backgrounds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DESDownloader.download_backgrounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DESDownloader.download_backgrounds" title="Link to this definition"></a></dt>
<dd><p>Download sky params for all image_ids.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DESDownloader.download_catalog">
<span class="sig-name descname"><span class="pre">download_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">des_image_id</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DESDownloader.download_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DESDownloader.download_catalog" title="Link to this definition"></a></dt>
<dd><p>Download tractor catalog given tractor-&lt;brick_name&gt;.fits filename.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DESDownloader.download_catalog_from_filename">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">download_catalog_from_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tractor_filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DESDownloader.download_catalog_from_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DESDownloader.download_catalog_from_filename" title="Link to this definition"></a></dt>
<dd><p>Download tractor catalog given tractor-&lt;brick_name&gt;.fits filename.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DESDownloader.download_image">
<span class="sig-name descname"><span class="pre">download_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">brickname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sky_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_basename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DESDownloader.download_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DESDownloader.download_image" title="Link to this definition"></a></dt>
<dd><p>Download image for specified band, for this brick/ccd.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DESDownloader.download_images">
<span class="sig-name descname"><span class="pre">download_images</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DESDownloader.download_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DESDownloader.download_images" title="Link to this definition"></a></dt>
<dd><p>Download images for all bands, for all image_ids.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DESDownloader.download_psfex">
<span class="sig-name descname"><span class="pre">download_psfex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">brickname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_filename_no_ext</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DESDownloader.download_psfex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DESDownloader.download_psfex" title="Link to this definition"></a></dt>
<dd><p>Download psfex file for specified band, for this brick/ccd.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DESDownloader.download_psfexs">
<span class="sig-name descname"><span class="pre">download_psfexs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DESDownloader.download_psfexs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DESDownloader.download_psfexs" title="Link to this definition"></a></dt>
<dd><p>Download psfex files for all image_ids.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.surveys.des.DESImageID">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.des.</span></span><span class="sig-name descname"><span class="pre">DESImageID</span></span><a class="headerlink" href="#bliss.surveys.des.DESImageID" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.surveys.des.DarkEnergySurvey">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.des.</span></span><span class="sig-name descname"><span class="pre">DarkEnergySurvey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psf_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bliss.simulator.psf.PSFConfig" title="bliss.simulator.psf.PSFConfig"><span class="pre">PSFConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data/des'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bliss.surveys.des.DESImageID" title="bliss.surveys.des.DESImageID"><span class="pre">DESImageID</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">({'ccdname':</span> <span class="pre">'S28',</span> <span class="pre">'decals_brickname':</span> <span class="pre">'3366m010',</span> <span class="pre">'g':</span> <span class="pre">'decam/CP/V4.8.2a/CP20171108/c4d_171109_002003_ooi_g_ls9',</span> <span class="pre">'i':</span> <span class="pre">'',</span> <span class="pre">'r':</span> <span class="pre">'decam/CP/V4.8.2a/CP20170926/c4d_170927_025457_ooi_r_ls9',</span> <span class="pre">'sky_coord':</span> <span class="pre">{'dec':</span> <span class="pre">-0.9316385797930247,</span> <span class="pre">'ra':</span> <span class="pre">336.6643042496718},</span> <span class="pre">'z':</span> <span class="pre">'decam/CP/V4.8.2a/CP20170926/c4d_170927_025655_ooi_z_ls9'},)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_image_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DarkEnergySurvey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DarkEnergySurvey" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DarkEnergySurvey.idx">
<span class="sig-name descname"><span class="pre">idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bliss.surveys.des.DESImageID" title="bliss.surveys.des.DESImageID"><span class="pre">DESImageID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DarkEnergySurvey.idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DarkEnergySurvey.idx" title="Link to this definition"></a></dt>
<dd><p>Return the index for the given image_id.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DarkEnergySurvey.image_id">
<span class="sig-name descname"><span class="pre">image_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bliss.surveys.des.DESImageID" title="bliss.surveys.des.DESImageID"><span class="pre">DESImageID</span></a></span></span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DarkEnergySurvey.image_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DarkEnergySurvey.image_id" title="Link to this definition"></a></dt>
<dd><p>Return the image_id for the given index.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DarkEnergySurvey.image_ids">
<span class="sig-name descname"><span class="pre">image_ids</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bliss.surveys.des.DESImageID" title="bliss.surveys.des.DESImageID"><span class="pre">DESImageID</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DarkEnergySurvey.image_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DarkEnergySurvey.image_ids" title="Link to this definition"></a></dt>
<dd><p>Return a list of all image_ids.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DarkEnergySurvey.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DarkEnergySurvey.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DarkEnergySurvey.prepare_data" title="Link to this definition"></a></dt>
<dd><p>pl.LightningDataModule override.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.DarkEnergySurvey.zpt_to_scale">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zpt_to_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zpt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#DarkEnergySurvey.zpt_to_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.DarkEnergySurvey.zpt_to_scale" title="Link to this definition"></a></dt>
<dd><p>Converts a magnitude zero point per sec to nelec/nmgy scale.</p>
<p>See also <a class="reference external" href="https://github.com/dstndstn/tractor/blob/">https://github.com/dstndstn/tractor/blob/</a>             cdb82000422e85c9c97b134edadff31d68bced0c/tractor/brightness.py#L217C6-L217C6</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>zpt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – magnitude zero point per sec</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>nelec/nmgy scale</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.surveys.des.SkyCoord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.des.</span></span><span class="sig-name descname"><span class="pre">SkyCoord</span></span><a class="headerlink" href="#bliss.surveys.des.SkyCoord" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.surveys.des.TractorFullCatalog">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.des.</span></span><span class="sig-name descname"><span class="pre">TractorFullCatalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#TractorFullCatalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.TractorFullCatalog" title="Link to this definition"></a></dt>
<dd><p>Class for the DECaLS Tractor Catalog.</p>
<p>Some resources:
- <a class="reference external" href="https://portal.nersc.gov/cfs/cosmo/data/legacysurvey/dr9/south/sweep/9.0/">https://portal.nersc.gov/cfs/cosmo/data/legacysurvey/dr9/south/sweep/9.0/</a>
- <a class="reference external" href="https://www.legacysurvey.org/dr9/files/#sweep-catalogs-region-sweep">https://www.legacysurvey.org/dr9/files/#sweep-catalogs-region-sweep</a>
- <a class="reference external" href="https://www.legacysurvey.org/dr5/description/#photometry">https://www.legacysurvey.org/dr5/description/#photometry</a>
- <a class="reference external" href="https://www.legacysurvey.org/dr9/bitmasks/">https://www.legacysurvey.org/dr9/bitmasks/</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.des.TractorFullCatalog.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cat_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">WCS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'r'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/des.html#TractorFullCatalog.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.des.TractorFullCatalog.from_file" title="Link to this definition"></a></dt>
<dd><p>Loads DECaLS catalog from FITS file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cat_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Path to .fits file.</p></li>
<li><p><strong>band</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Band to read from. Defaults to “r”.</p></li>
<li><p><strong>wcs</strong> (<em>WCS</em>) – WCS object for the image.</p></li>
<li><p><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Height of the image.</p></li>
<li><p><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Width of the image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A TractorFullCatalog containing data from the provided file.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-surveys-dc2-module">
<h3>bliss.surveys.dc2 module<a class="headerlink" href="#bliss-surveys-dc2-module" title="Link to this heading"></a></h3>
<p>DESC DC2 simulated survey data loader.</p>
<dl class="py class" id="module-bliss.surveys.dc2">
<dt class="sig sig-object py" id="bliss.surveys.dc2.DC2DataModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.dc2.</span></span><span class="sig-name descname"><span class="pre">DC2DataModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dc2_image_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc2_cat_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_lim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_image_split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_slen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sources_per_tile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog_min_r_flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data_processes_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_in_one_cached_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cached_data_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_transforms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nontrain_transforms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_file_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/dc2.html#DC2DataModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.dc2.DC2DataModule" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.dc2.DC2DataModule.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/dc2.html#DC2DataModule.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.dc2.DC2DataModule.prepare_data" title="Link to this definition"></a></dt>
<dd><p>Use this to download and prepare data. Downloading and saving data with multiple processes (distributed
settings) will result in corrupted data. Lightning ensures this method is called only within a single process,
so you can safely add your downloading logic within.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>DO NOT set state to the model (use <code class="docutils literal notranslate"><span class="pre">setup</span></code> instead)
since this is NOT called on every device</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">prepare_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># good</span>
    <span class="n">download_data</span><span class="p">()</span>
    <span class="n">tokenize</span><span class="p">()</span>
    <span class="n">etc</span><span class="p">()</span>

    <span class="c1"># bad</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split</span> <span class="o">=</span> <span class="n">data_split</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">some_state</span> <span class="o">=</span> <span class="n">some_other_state</span><span class="p">()</span>
</pre></div>
</div>
<p>In a distributed environment, <code class="docutils literal notranslate"><span class="pre">prepare_data</span></code> can be called in two ways
(using <a class="reference external" href="https://lightning.ai/docs/pytorch/stable/common/lightning_module.html#prepare-data-per-node" title="(in PyTorch Lightning v2.6.0)"><span class="xref std std-ref">prepare_data_per_node</span></a>)</p>
<ol class="arabic simple">
<li><p>Once per node. This is the default and is only called on LOCAL_RANK=0.</p></li>
<li><p>Once in total. Only called on GLOBAL_RANK=0.</p></li>
</ol>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># DEFAULT</span>
<span class="c1"># called once per node on LOCAL_RANK=0 of that node</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LitDataModule</span><span class="p">(</span><span class="n">LightningDataModule</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_data_per_node</span> <span class="o">=</span> <span class="kc">True</span>


<span class="c1"># call on GLOBAL_RANK=0 (great for shared file systems)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LitDataModule</span><span class="p">(</span><span class="n">LightningDataModule</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_data_per_node</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>This is called before requesting the dataloaders:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">()</span>
<span class="n">initialize_distributed</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">val_dataloader</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">test_dataloader</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict_dataloader</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bliss.surveys.dc2.DC2FullCatalog">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.surveys.dc2.</span></span><span class="sig-name descname"><span class="pre">DC2FullCatalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/dc2.html#DC2FullCatalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.dc2.DC2FullCatalog" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.surveys.dc2.DC2FullCatalog.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cat_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/surveys/dc2.html#DC2FullCatalog.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.surveys.dc2.DC2FullCatalog.from_file" title="Link to this definition"></a></dt>
<dd><p>Loads FullCatalog from disk.</p>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-surveys-download-utils-module">
<h3>bliss.surveys.download_utils module<a class="headerlink" href="#bliss-surveys-download-utils-module" title="Link to this heading"></a></h3>
<p>Utilities for downloading survey data.</p>
</section>
</section>
<section id="simulator-package">
<span id="module-bliss.surveys.download_utils"></span><h2>Simulator Package<a class="headerlink" href="#simulator-package" title="Link to this heading"></a></h2>
<p>Image simulation and prior distributions.</p>
<section id="bliss-simulator-decoder-module">
<span id="module-bliss.simulator"></span><h3>bliss.simulator.decoder module<a class="headerlink" href="#bliss-simulator-decoder-module" title="Link to this heading"></a></h3>
<p>Image decoder for rendering synthetic telescope images.</p>
<dl class="py class" id="module-bliss.simulator.decoder">
<dt class="sig sig-object py" id="bliss.simulator.decoder.Decoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.simulator.decoder.</span></span><span class="sig-name descname"><span class="pre">Decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile_slen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">survey</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bliss.surveys.survey.Survey" title="bliss.surveys.survey.Survey"><span class="pre">Survey</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_survey_background</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_dither</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/simulator/decoder.html#Decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.simulator.decoder.Decoder" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="bliss.simulator.decoder.Decoder.pixel_shifts">
<span class="sig-name descname"><span class="pre">pixel_shifts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/simulator/decoder.html#Decoder.pixel_shifts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.simulator.decoder.Decoder.pixel_shifts" title="Link to this definition"></a></dt>
<dd><p>Generate random pixel shifts and corresponding WCS list.
This function generates <cite>n_shifts</cite> random pixel shifts <cite>shifts</cite> and corresponding WCS list
<cite>wcs</cite> to undo these shifts, relative to <cite>wcs[ref_band]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of pixel shifts
wcs (List[WCS]): list of WCS objects</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>shifts (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.simulator.decoder.Decoder.render_bulge_plus_disk">
<span class="sig-name descname"><span class="pre">render_bulge_plus_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/simulator/decoder.html#Decoder.render_bulge_plus_disk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.simulator.decoder.Decoder.render_bulge_plus_disk" title="Link to this definition"></a></dt>
<dd><p>Render a galaxy with given params.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – band</p></li>
<li><p><strong>source_params</strong> (<em>Tensor</em>) – Tensor containing the parameters for a particular source
(see prior.py for details about these parameters)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a galsim representation of the rendered galaxy</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>GSObject</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.simulator.decoder.Decoder.render_galaxy">
<span class="sig-name descname"><span class="pre">render_galaxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/simulator/decoder.html#Decoder.render_galaxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.simulator.decoder.Decoder.render_galaxy" title="Link to this definition"></a></dt>
<dd><p>Render a galaxy with given params and PSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psf</strong> (<em>List</em>) – a list of PSFs for each band</p></li>
<li><p><strong>band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – band</p></li>
<li><p><strong>source_params</strong> (<em>Tensor</em>) – Tensor containing the parameters for a particular source
(see prior.py for details about these parameters)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a galsim representation of the rendered galaxy convolved with the PSF</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>GSObject</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.simulator.decoder.Decoder.render_image">
<span class="sig-name descname"><span class="pre">render_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile_cat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/simulator/decoder.html#Decoder.render_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.simulator.decoder.Decoder.render_image" title="Link to this definition"></a></dt>
<dd><p>Render a single image from a tile catalog.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.simulator.decoder.Decoder.render_images">
<span class="sig-name descname"><span class="pre">render_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile_cat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/simulator/decoder.html#Decoder.render_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.simulator.decoder.Decoder.render_images" title="Link to this definition"></a></dt>
<dd><p>Render images from a tile catalog.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bliss.simulator.decoder.Decoder.render_star">
<span class="sig-name descname"><span class="pre">render_star</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/simulator/decoder.html#Decoder.render_star"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.simulator.decoder.Decoder.render_star" title="Link to this definition"></a></dt>
<dd><p>Render a star with given params and PSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_params</strong> (<em>Tensor</em>) – Tensor containing the parameters for a particular source
(see prior.py for details about these parameters)</p></li>
<li><p><strong>psf</strong> (<em>List</em>) – a list of PSFs for each band</p></li>
<li><p><strong>band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – band</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a galsim representation of the rendered star convolved with the PSF</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>GSObject</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-simulator-prior-module">
<h3>bliss.simulator.prior module<a class="headerlink" href="#bliss-simulator-prior-module" title="Link to this heading"></a></h3>
<p>Prior distributions over light source catalogs.</p>
<dl class="py class" id="module-bliss.simulator.prior">
<dt class="sig sig-object py" id="bliss.simulator.prior.CatalogPrior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.simulator.prior.</span></span><span class="sig-name descname"><span class="pre">CatalogPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">survey_bands</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_tiles_h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_tiles_w</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_sources</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sources</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_sources</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_galaxy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">star_flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">galaxy_flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">galaxy_a_concentration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">galaxy_a_loc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">galaxy_a_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">galaxy_a_bd_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">star_color_model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">gal_color_model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_band</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bliss/simulator/prior.html#CatalogPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.simulator.prior.CatalogPrior" title="Link to this definition"></a></dt>
<dd><p>Prior distribution of objects in an astronomical image.</p>
<p>After the module is initialized, sampling is done with the sample method.
The input parameters correspond to the number of sources, the fluxes, whether an
object is a galaxy or star, and the distributions of galaxy and star shapes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bliss.simulator.prior.CatalogPrior.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bliss.catalog.TileCatalog" title="bliss.catalog.TileCatalog"><span class="pre">TileCatalog</span></a></span></span><a class="reference internal" href="../_modules/bliss/simulator/prior.html#CatalogPrior.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bliss.simulator.prior.CatalogPrior.sample" title="Link to this definition"></a></dt>
<dd><p>Samples latent variables from the prior of an astronomical image.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of tensors. Each tensor is a particular per-tile quantity; i.e.
the first three dimensions of each tensor are
<cite>(batch_size, self.n_tiles_h, self.n_tiles_w)</cite>.
The remaining dimensions are variable-specific.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="bliss-simulator-psf-module">
<h3>bliss.simulator.psf module<a class="headerlink" href="#bliss-simulator-psf-module" title="Link to this heading"></a></h3>
<p>Point spread function utilities.</p>
<dl class="py class" id="module-bliss.simulator.psf">
<dt class="sig sig-object py" id="bliss.simulator.psf.PSFConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bliss.simulator.psf.</span></span><span class="sig-name descname"><span class="pre">PSFConfig</span></span><a class="headerlink" href="#bliss.simulator.psf.PSFConfig" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Bliss API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Probabilistic Machine Learning Research Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>