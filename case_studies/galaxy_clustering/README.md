# Inference on Galaxy Cluster Fields

Summer 2024

[Ishan Kapnadak](https://www.linkedin.com/in/ishan-kapnadak/), [Gabriel Patron](https://lsa.umich.edu/stats/people/phd-students/gapatron.html), [Prof. Jeffrey Regier](https://regier.stat.lsa.umich.edu/), [Prof. Camille Avestruz](https://cavestruz.github.io/).

Built on work done in Winter 2024 by [Li Shihang](https://www.linkedin.com/in/shihang-li-2b69251ba/), Zhao Yongxiang.

----------------------------------------------------------------------------------------------------------------------

## Generation of Data

The data generation routine proceeds through phases, each contained within its own script within the `data_generation` subdirectory. The entire routine is conveniently wrapped into a single shell script, that performs calls to these three scripts. These phases proceed as follows.

1. **Catalog Generation.** `catalog_gen.py` samples semi-synthetic source catalogs with their relevant properties, which are stored as `.dat` files in the `data/catalogs` subdirectory. Keyword arguments: `image_size` and `nfiles`.
2. **Image Generation.** `galsim-des.yaml` takes in the aforementioned source catalogs and uses GalSim to render them as images, which are stored as `.fits` files (one for each band) in the `data/images` subdirectory. Keyword arguments: `image_size` and `nfiles`.
3. **File Datum Generation.** `file_datum_generation.py` converts the full source catalogs generated in phase 1 into tile catalogs, stacks them up with their corresponding images, and stores these objects as `.pt` files (which is what the encoder ultimately uses) in the `data/file_data` subdirectory. Keyword arguments: `image_size` and `tile_size`.

Data can be generated by running the bash scipt `data-gen.sh`. The bash script has 3 options:
1. `-n`: the number of files to be generated (defaults to 100)
2. `-s`: the size of the image (defaults to 4800)
3. `-t`: the tile size (defaults to 4)

As an example, the command

```
bash data-gen.sh -n 10 -s 1280 -t 128
```

generates 10 images of size 1280 x 1280 tiled with a tile size of 128 x 128.
