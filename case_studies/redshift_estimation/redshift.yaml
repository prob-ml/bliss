---
defaults:
    - ../../bliss/conf@_here_: base_config
    - _self_
    - override hydra/job_logging: stdout

paths:
    root: ${oc.env:BLISS_HOME}
    data: ${paths.root}/data
    sdss: ${paths.data}/sdss
    output: ${paths.root}/redshift_output

prior:
    _target_: case_studies.redshift_estimation.prior.RedshiftUniformPrior
    redshift_min: 0.99
    redshift_max: 1.01

simulator:
    _target_: case_studies.redshift_estimation.simulated_dataset.RedshiftSimulatedDataset

encoder:
    vd_spec:
        _target_: case_studies.redshift_estimation.variational_dist.RedshiftVariationalDistSpec
    double_detect: false
    use_checkerboard: false
    metrics:
        _target_: torchmetrics.MetricCollection
        metrics:
          - _target_: case_studies.redshift_estimation.metrics.RedshiftMeanSquaredError
          - _target_: case_studies.redshift_estimation.metrics.RedshiftCatastrophicErrorRate
          - _target_: case_studies.redshift_estimation.metrics.RedshiftNLL

generate:
    n_image_files: 16
    n_batches_per_file: 16
    cached_data_path: /data/scratch/declan/redshift_estimation_test

cached_simulator:
    _target_: case_studies.redshift_estimation.simulated_dataset.RedshiftCachedSimulatedDataset
    cached_data_path: /data/scratch/declan/redshift_estimation
    batch_size: 32

cached_test_data:
    _target_: case_studies.redshift_estimation.simulated_dataset.RedshiftCachedSimulatedDataset
    batch_size: 32
    splits: 0:80/80:90/90:100  # train/val/test splits as percent ranges
    num_workers: 0
    file_prefix: ${generate.file_prefix}
    cached_data_path: /data/scratch/declan/redshift_estimation_test

predict:
    dataset: ${cached_test_data}
